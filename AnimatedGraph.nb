(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     53252,       1230]
NotebookOptionsPosition[     48760,       1153]
NotebookOutlinePosition[     49096,       1168]
CellTagsIndexPosition[     49053,       1165]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"applyForces", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"node", ",", "force", ",", "timeStep"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"node", "+", 
       RowBox[{"force", "*", "timeStep"}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"calcPairwiseForce", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"node1", ",", "node2"}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "distance", ",", "intendedDistance", ",", "displacement", ",", 
          "force"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"distance", "=", 
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"node1", ",", "node2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"intendedDistance", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"displacement", "=", 
          RowBox[{"node2", "-", "node1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"force", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"intendedDistance", "/", "distance"}]}], ")"}], "*", 
           "displacement", "*", "0.3"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"calcAndApply", "=", 
   RowBox[{"Function", "[", 
    RowBox[{"timeStep", ",", "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{"t", ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "l", ",", "forces", ",", "newNodes", ",", "i", ",", "j", ",", 
           "resultingForce"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"l", "=", 
           RowBox[{"Length", "[", "nodes", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"forces", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "l"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newNodes", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"Null", ",", "l"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"i", "\[LessEqual]", "l"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"j", "\[LessEqual]", "l"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"resultingForce", "=", 
                 RowBox[{"calcPairwiseForce", "[", 
                  RowBox[{
                   RowBox[{"nodes", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"nodes", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"forces", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"forces", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", "resultingForce"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"forces", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"forces", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "-", "resultingForce"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"j", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"newNodes", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", 
              RowBox[{"applyForces", "[", 
               RowBox[{
                RowBox[{"nodes", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"forces", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "timeStep"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nodes", "=", "newNodes"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7760694820910873`*^9, 3.77606948432171*^9}, {
  3.776069643457513*^9, 3.776069726017859*^9}, {3.776791757620229*^9, 
  3.7767917609706078`*^9}},ExpressionUUID->"268c18ec-2a20-406e-a17c-\
e9e0fb4da4ce"],

Cell[BoxData["  "], "Input",
 CellChangeTimes->{{3.7760770285421762`*^9, 
  3.776077028606814*^9}},ExpressionUUID->"7789435e-6e40-4db0-8be4-\
6cd58d49e335"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7760730302155447`*^9, 3.776073054645276*^9}, 
   3.776073459297648*^9},ExpressionUUID->"a328df04-c69b-4ff9-a715-\
e2ffd5343689"],

Cell[BoxData[
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"Graph", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "\[UndirectedEdge]", "2"}], ",", 
       RowBox[{"2", "\[UndirectedEdge]", "3"}], ",", 
       RowBox[{"3", "\[UndirectedEdge]", "1"}], ",", 
       RowBox[{"3", "\[UndirectedEdge]", "4"}], ",", 
       RowBox[{"4", "\[UndirectedEdge]", "5"}], ",", 
       RowBox[{"5", "\[UndirectedEdge]", "6"}], ",", 
       RowBox[{"6", "\[UndirectedEdge]", "1"}]}], "}"}], ",", 
     RowBox[{"VertexCoordinates", "\[Rule]", 
      RowBox[{"update", "[", "t", "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "4"}], ",", "8"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "16"}], ",", "0"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "tMax", ",", "timeStep"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.776073696517765*^9, 3.7760736971962233`*^9}, {
  3.7760749314030247`*^9, 3.7760749433898783`*^9}, {3.776075102982834*^9, 
  3.7760751041962643`*^9}, {3.776075225691886*^9, 3.7760752794066257`*^9}, {
  3.776075936386752*^9, 3.7760759496735487`*^9}, {3.776691969094486*^9, 
  3.776691976545294*^9}, {3.776692019367071*^9, 3.7766920821726418`*^9}, {
  3.776692185910267*^9, 3.7766921860256157`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"c6453f2f-8ac9-4f00-9fa2-e622e4a527e6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graph", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[UndirectedEdge]", "2"}], ",", 
     RowBox[{"2", "\[UndirectedEdge]", "3"}], ",", 
     RowBox[{"3", "\[UndirectedEdge]", "1"}]}], "}"}], ",", 
   RowBox[{"VertexCoordinates", "\[Rule]", 
    RowBox[{"update", "[", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.776072914835887*^9, 3.7760729163813133`*^9}, {
  3.776072951636415*^9, 3.77607298683463*^9}, {3.776073067664126*^9, 
  3.776073106437106*^9}, {3.7760734203202333`*^9, 3.776073439244117*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"451b7111-16ee-44ba-bf7d-3c536b493a0e"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3}, {Null, {{1, 2}, {2, 3}, {3, 1}}}, {
      VertexCoordinates -> {{2.0193286300289994`, -0.6594509128028458}, {
        2., -0.6810981743943082}, {
        1.980671369971001, -0.659450912802846}}}]]}, 
    TagBox[
     GraphicsGroupBox[
      GraphicsComplexBox[{{2.0193286300289994`, -0.6594509128028458}, {
       2., -0.6810981743943082}, {1.980671369971001, -0.659450912802846}}, {
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], LineBox[{{1, 2}, {1, 3}, {2, 3}}]}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         DiskBox[1, 0.0004921069205383198], DiskBox[2, 0.0004921069205383198],
          DiskBox[3, 0.0004921069205383198]}}]],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.7760730833411903`*^9, 3.776073107058176*^9}, {
  3.776073427315178*^9, 3.776073445233934*^9}, {3.776073573609645*^9, 
  3.7760735805245457`*^9}, {3.7760737050697412`*^9, 3.776073741501009*^9}},
 CellLabel->"Out[91]=",ExpressionUUID->"9111b64d-2c64-495e-992a-02d2fcd5fa4a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{"x", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.776709332659587*^9, 3.776709350097303*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"a8f26e4e-98ad-4766-bd91-461786c0940b"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`x$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`x$$], 0, 1}}, Typeset`size$$ = {8., {1., 9.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`x$43093$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`x$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`x$$, $CellContext`x$43093$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> $CellContext`x$$, 
      "Specifications" :> {{$CellContext`x$$, 0, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{247., {51., 57.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.776709350544676*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"f1bc1213-b1b0-4c6f-93e8-16136168eb39"]
}, Open  ]],

Cell[BoxData["\[AliasDelimiter]"], "Input",
 CellChangeTimes->{{3.776779030530241*^9, 
  3.77677903398147*^9}},ExpressionUUID->"b33ce7e8-b975-447e-8581-\
142ccb6e683f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"col", "=", "Green"}], "}"}], ",", 
   RowBox[{"EventHandler", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"\"\<text\>\"", ",", 
       RowBox[{"FontColor", "\[Rule]", 
        RowBox[{"Dynamic", "[", "col", "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<KeyDown\>\"", ",", "\"\<ShiftKey\>\""}], "}"}], 
       "\[RuleDelayed]", 
       RowBox[{"Print", "[", "ok", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.776779143639847*^9, 3.776779149568561*^9}, {
  3.776779450365943*^9, 3.7767796585189953`*^9}, {3.776780142106357*^9, 
  3.7767801873743258`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"2bebbf99-f8f6-434c-97e1-4e52b9bba141"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`col$$ = RGBColor[0, 1, 0]}, 
  TagBox[
   StyleBox["\<\"text\"\>",
    StripOnInput->False,
    FontColor->Dynamic[$CellContext`col$$]],
   EventHandlerTag[{{"KeyDown", "ShiftKey"} :> Print[$CellContext`ok], Method -> 
     "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{{3.776779515397554*^9, 3.776779651726019*^9}, {
  3.776780145107318*^9, 3.776780190500647*^9}},
 CellLabel->"Out[42]=",ExpressionUUID->"31862016-d7a3-454e-a7df-10a1c0035f9f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  DynamicModuleBox[{$CellContext`col$$ = RGBColor[0, 1, 0]}, 
   TagBox[
    StyleBox["\"\<text\>\"",
     StripOnInput->False,
     FontColor->Dynamic[$CellContext`col$$]],
    EventHandlerTag[{{"KeyDown", "x"} :> ($CellContext`col$$ = 
       ReplaceAll[$CellContext`col$$, {Red -> Green, Green -> Red}]), Method -> 
      "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]],
   DynamicModuleValues:>{}], "x"}]], "Input",
 CellChangeTimes->{{3.776779513563551*^9, 
  3.7767795135719423`*^9}},ExpressionUUID->"f7d94a30-ff33-4578-9c00-\
4218ff3761bb"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`col$$ = RGBColor[1, 0, 0]}, 
  TagBox[
   StyleBox["\"\<text\>\"",
    StripOnInput->False,
    FontColor->Dynamic[$CellContext`col$$]],
   EventHandlerTag[{{"KeyDown", "x"} :> ($CellContext`col$$ = 
      ReplaceAll[$CellContext`col$$, {Red -> Green, Green -> Red}]), Method -> 
     "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]],
  DynamicModuleValues:>{}]], "Input",
 CellChangeTimes->{{3.776779507163762*^9, 
  3.7767795097720013`*^9}},ExpressionUUID->"27f68aee-3581-427a-9925-\
090fbb926d3c"],

Cell[BoxData["x"], "Input",
 CellChangeTimes->{
  3.776779500310121*^9},ExpressionUUID->"ab3dd3e8-d75f-4a3d-8442-\
a436cb6678f5"],

Cell[CellGroupData[{

Cell[BoxData["\[CommandKey]"], "Input",
 CellChangeTimes->{{3.7767791172158613`*^9, 3.7767791172321653`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"f39510a3-8f7a-4a1a-ab7b-1fdffd103d94"],

Cell[BoxData["\[CommandKey]"], "Output",
 CellChangeTimes->{3.776779120129036*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"cbf301a3-586f-491e-bdb9-d22d86866af8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"key", "=", "\"\<x\>\""}], "}"}], ",", 
    RowBox[{"EventHandler", "[", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"Dynamic", "[", "key", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<KeyDown\>\"", "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"key", "=", 
          RowBox[{"CurrentValue", "[", "\"\<EventKey\>\"", "]"}]}], ")"}]}], 
       "}"}]}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7767798541344967`*^9, 3.776779919445904*^9}, {
  3.776780045024919*^9, 3.776780097512498*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"ccda298a-6f54-4a06-9708-713513589d80"],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`key$24957, StandardForm],
  ImageSizeCache->{65., {3., 9.}}]], "Print",
 CellChangeTimes->{{3.776780055258757*^9, 3.776780098729636*^9}},
 CellLabel->
  "During evaluation of \
In[37]:=",ExpressionUUID->"057fabcc-6cbb-4487-ad92-5c1fed05f441"]
}, Open  ]],

Cell[BoxData["event"], "Input",
 CellChangeTimes->{{3.77678010421681*^9, 
  3.776780104638865*^9}},ExpressionUUID->"afb3fa59-c89f-4f6e-ab2d-\
9e4c4e9a3efc"],

Cell[BoxData["s"], "Input",
 CellChangeTimes->{
  3.776779913771824*^9},ExpressionUUID->"9f0e60b7-423d-4406-a0ad-\
a40ee8db7ec4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"col", "=", "Green"}], "}"}], ",", 
   RowBox[{"EventHandler", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Dynamic", "@", "key"}], ",", 
       RowBox[{"FontColor", "\[Rule]", 
        RowBox[{"Dynamic", "[", "col", "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<KeyDown\>\"", "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"key", "=", 
         RowBox[{"CurrentValue", "[", "\"\<EventKey\>\"", "]"}]}], ")"}]}], 
      "}"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{
  3.776779957779367*^9, {3.7769737091184797`*^9, 3.7769737629302197`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"3834825e-41c4-4d9c-a8bd-dace26627a5d"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`col$$ = RGBColor[0, 1, 0]}, 
  TagBox[
   StyleBox[
    DynamicBox[ToBoxes[$CellContext`key, StandardForm],
     ImageSizeCache->{23., {3., 10.}}],
    StripOnInput->False,
    FontColor->Dynamic[$CellContext`col$$]],
   EventHandlerTag[{
    "KeyDown" :> ($CellContext`key = CurrentValue["EventKey"]), Method -> 
     "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> True}]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{
  3.776779959522703*^9, {3.776973720796795*^9, 3.776973764642898*^9}},
 CellLabel->
  "Out[260]=",ExpressionUUID->"7ed8bfff-0f59-4f04-896b-d53489533681"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClickPane", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Yellow", ",", 
           RowBox[{"Disk", "[", "pt", "]"}], ",", "Black", ",", 
           RowBox[{"Point", "[", "pt", "]"}]}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pt", "=", "#"}], ")"}], "&"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
       RowBox[{"Print", "[", "yes", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.776780217402338*^9, 3.776780300724901*^9}, {
   3.7767804166829987`*^9, 3.77678041747089*^9}, {3.7767805283948193`*^9, 
   3.776780590109906*^9}, {3.776781169912866*^9, 3.776781195705003*^9}, {
   3.776781380116396*^9, 3.776781380215357*^9}, {3.776782281188299*^9, 
   3.7767823214705276`*^9}, {3.7767824148477373`*^9, 3.776782416819969*^9}, {
   3.776786366407948*^9, 3.776786375472555*^9}, {3.776786438906321*^9, 
   3.776786462311014*^9}, {3.776786678890168*^9, 3.776786679153296*^9}, {
   3.776786718868877*^9, 3.7767867209111013`*^9}, {3.776786757701277*^9, 
   3.776786761025957*^9}, {3.77678690468172*^9, 3.776786952062997*^9}, {
   3.776787026543996*^9, 3.776787058761373*^9}, {3.776787109997295*^9, 
   3.776787120596126*^9}, {3.776787189277389*^9, 3.776787194625471*^9}, {
   3.776787243033587*^9, 3.776787247309944*^9}, {3.776787303921397*^9, 
   3.776787315038768*^9}, 3.776790724010592*^9, {3.776790792053718*^9, 
   3.7767908364223423`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"2f03301e-58ed-4bcc-9499-183e73eaaeae"],

Cell[BoxData[
 TagBox[
  TagBox[
   GraphicsBox[{
     {RGBColor[1, 1, 0], DiskBox[{3.8964704788643267, 4.530356373157697}]}, 
     {GrayLevel[0], PointBox[{3.8964704788643267`, 4.530356373157697}]}},
    ImageSize->Tiny],
   EventHandlerTag[{"MouseClicked" :> (($CellContext`pt = #)& )[
       MousePosition["EventHandlerAutomatic"]], Method -> "Preemptive", 
     PassEventsDown -> Automatic, PassEventsUp -> True}]],
  EventHandlerTag[{
   "MouseClicked" :> Print[$CellContext`yes], Method -> "Preemptive", 
    PassEventsDown -> Automatic, PassEventsUp -> True}]]], "Output",
 CellChangeTimes->{{3.7767870446631927`*^9, 3.77678712687383*^9}, {
   3.776787195295925*^9, 3.776787209798699*^9}, 3.776787248554287*^9, {
   3.776790727043812*^9, 3.7767907562054873`*^9}, {3.7767908016553392`*^9, 
   3.7767908367703857`*^9}},
 CellLabel->"Out[89]=",ExpressionUUID->"916f3578-5003-4ca3-a3e9-fd4522834fa4"],

Cell[CellGroupData[{

Cell[BoxData["yes"], "Print",
 CellChangeTimes->{3.776790839430223*^9},
 CellLabel->"",ExpressionUUID->"2edebf36-158b-479e-b9bd-83a3c0ff9bc6"],

Cell[BoxData["yes"], "Print",
 CellChangeTimes->{3.7767908401274*^9},
 CellLabel->"",ExpressionUUID->"8b82d613-7486-4a19-b890-51d62c8ca6b4"],

Cell[BoxData["yes"], "Print",
 CellChangeTimes->{3.776790840706216*^9},
 CellLabel->"",ExpressionUUID->"d479e5d2-63ee-4458-9a67-836ad7c3ea85"],

Cell[BoxData["yes"], "Print",
 CellChangeTimes->{3.776790841378173*^9},
 CellLabel->"",ExpressionUUID->"cc7e5abf-bcec-4995-ba07-5e7679a4090f"],

Cell[BoxData["yes"], "Print",
 CellChangeTimes->{3.776790948641428*^9},
 CellLabel->"",ExpressionUUID->"8d950539-6ad7-4f6c-8df2-29b46c64faf3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Pane", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Yellow", ",", 
           RowBox[{"Disk", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", "Black", ",", 
           RowBox[{"Point", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Tiny"}]}], "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
       RowBox[{"Print", "[", "yes", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7767910358165483`*^9, 3.776791052583145*^9}, {
  3.776791092897251*^9, 3.77679109444827*^9}, {3.776791189475605*^9, 
  3.776791277930567*^9}, {3.776791355652547*^9, 3.776791412590289*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"78a8a015-6b98-45b3-aa32-210b0a8057a2"],

Cell[BoxData[
 TagBox[
  PaneBox[
   GraphicsBox[{
     {RGBColor[1, 1, 0], DiskBox[{0, 0}]}, 
     {GrayLevel[0], PointBox[{0, 0}]}},
    ImageSize->Tiny],
   ImageSize->Large],
  EventHandlerTag[{
   "MouseClicked" :> Print[$CellContext`yes], Method -> "Preemptive", 
    PassEventsDown -> Automatic, PassEventsUp -> True}]]], "Output",
 CellChangeTimes->{
  3.7767910994352922`*^9, {3.77679124072865*^9, 3.776791278379038*^9}, {
   3.776791356855744*^9, 3.776791413300241*^9}},
 CellLabel->"Out[98]=",ExpressionUUID->"b84d3ae4-a91c-4f6c-827c-d77270eedc1d"],

Cell[CellGroupData[{

Cell[BoxData["yes"], "Print",
 CellChangeTimes->{3.776791420156205*^9},
 CellLabel->"",ExpressionUUID->"3074ecb4-d6c5-4715-b00c-46124fbfd1d0"],

Cell[BoxData["yes"], "Print",
 CellChangeTimes->{3.7767914207457647`*^9},
 CellLabel->"",ExpressionUUID->"4e1be556-89cd-47e5-aaf2-ad4e03d96ccb"],

Cell[BoxData["yes"], "Print",
 CellChangeTimes->{3.77679142128067*^9},
 CellLabel->"",ExpressionUUID->"10a6842b-8cb1-4384-9bd5-cc2e38cd310e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"update", "=", 
   RowBox[{"calcAndApply", "[", "timeStep", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nodes", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"i", "-", "2"}], ")"}], "2"]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timeStep", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tMax", "=", "10"}], ";"}]}], "Input",
 CellChangeTimes->{{3.776070618906891*^9, 3.7760706234487877`*^9}, {
   3.776071513319675*^9, 3.776071522427601*^9}, {3.776072557048416*^9, 
   3.7760725677901583`*^9}, {3.776073464105617*^9, 3.7760734652847433`*^9}, 
   3.77607504056853*^9, {3.7760759291870728`*^9, 3.7760759294876623`*^9}, {
   3.7766919957050533`*^9, 3.776692014041977*^9}, {3.776692188550312*^9, 
   3.776692188657213*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"41fcb8d8-8adc-49ea-ae69-cc7cdd723e2e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"-", "9"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", 
     RowBox[{"-", "16"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.776075041186803*^9, 3.776075220897955*^9, 
  3.776075381932543*^9, 3.776075473173629*^9, 3.776075955125001*^9, 
  3.77669166077425*^9, 3.7766919977601633`*^9, 3.7766920370552464`*^9, 
  3.776692090283173*^9, 3.776692189276762*^9, 3.776716466623283*^9, 
  3.776778839223733*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"ac46f58f-26bb-4366-98dc-c10ada7cf71e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"graphStructure", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Dynamic", "@", 
      RowBox[{"GraphPlot", "[", 
       RowBox[{
        RowBox[{"Graph", "[", 
         RowBox[{
          RowBox[{"graphStructure", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"graphStructure", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{"VertexCoordinates", "\[Rule]", 
           RowBox[{"graphStructure", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"VertexSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2"}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "100"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mouseClicked", "=", "True"}], ",", " ", 
         RowBox[{"mousePosition", "=", 
          RowBox[{"MousePosition", "[", "]"}]}]}], ")"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<KeyDown\>\"", ",", "\"\<n\>\""}], "}"}], 
       "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"newNode", "=", "True"}], ")"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<KeyDown\>\"", ",", "\"\<e\>\""}], "}"}], 
       "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"newEdge", "=", "True"}], ")"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<KeyDown\>\"", ",", "\"\<z\>\""}], "}"}], 
       "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"newEdge", "=", "True"}], ")"}]}], "}"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "\n", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7767956927613688`*^9, 3.776795722143518*^9}, {
   3.776795777134136*^9, 3.776795789101675*^9}, {3.7767958495305*^9, 
   3.776795872498159*^9}, {3.776795912687632*^9, 3.776795939859826*^9}, {
   3.776795972031784*^9, 3.776796083025682*^9}, {3.77679614514832*^9, 
   3.7767961776704817`*^9}, {3.776796570949445*^9, 3.776796571697009*^9}, {
   3.776796906228705*^9, 3.776796933458982*^9}, {3.776797533082973*^9, 
   3.7767975331678953`*^9}, {3.776801065061388*^9, 3.776801066210096*^9}, {
   3.776940570411495*^9, 3.776940638929809*^9}, {3.776958410427479*^9, 
   3.776958424775086*^9}, {3.7769588236101933`*^9, 3.7769588656636457`*^9}, {
   3.7769589139167757`*^9, 3.776958915377692*^9}, {3.7769599810411367`*^9, 
   3.7769599856127987`*^9}, 3.776960077715427*^9, {3.776960644565133*^9, 
   3.776960681811738*^9}, {3.7769641923743753`*^9, 3.776964202608375*^9}, {
   3.7769642537002783`*^9, 3.7769642590878143`*^9}, {3.77696431068857*^9, 
   3.776964358974657*^9}, {3.776964454307725*^9, 3.7769644910637093`*^9}, {
   3.776964608960772*^9, 3.776964655834683*^9}, {3.77696492552791*^9, 
   3.776964926395006*^9}, {3.776965442368849*^9, 3.7769654773561296`*^9}, {
   3.77696725553928*^9, 3.776967329312161*^9}, {3.7769673667113*^9, 
   3.7769673694262657`*^9}, {3.776968937748393*^9, 3.776968968965802*^9}, {
   3.776969039248543*^9, 3.776969040608583*^9}, {3.7769691664659367`*^9, 
   3.776969230409206*^9}, {3.776969262028481*^9, 3.776969330670659*^9}, {
   3.776973627127301*^9, 3.776973633165987*^9}, 3.777231798257736*^9},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"375bdd94-dcce-42c8-bbd5-a89c89d8e59c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"notNull", "=", 
    RowBox[{"Function", "[", 
     RowBox[{"x", ",", "\[IndentingNewLine]", 
      RowBox[{"Not", "[", 
       RowBox[{"TrueQ", "[", 
        RowBox[{"x", "\[Equal]", "Null"}], "]"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"graphPanel", "=", 
   RowBox[{"Function", "[", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"aMatrix", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"nodeCoords", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"15", ",", "15"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"originNode", "=", "Null"}], ",", "\[IndentingNewLine]", 
        RowBox[{"invisibleEdge", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Opacity", "[", "0", "]"}], ",", 
           RowBox[{"Arrow", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",",
         "\[IndentingNewLine]", "tempEdge", ",", "\[IndentingNewLine]", 
        RowBox[{"locked", "=", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{"arrivalNode", "=", "Null"}]}], "\[IndentingNewLine]", "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tempEdge", "=", "invisibleEdge"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"resetActionVariables", "=", 
        RowBox[{"Function", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tempEdge", "=", "invisibleEdge"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"originNode", "=", "Null"}], ";", "\[IndentingNewLine]", 
          RowBox[{"arrivalNode", "=", "Null"}], ";", "\[IndentingNewLine]", 
          RowBox[{"locked", "=", "False"}], ";"}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"addNode", "=", 
        RowBox[{"Function", "[", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"numberOfNodes", ",", "newAMatrix", ",", "i"}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"numberOfNodes", "=", 
             RowBox[{"Length", "[", "aMatrix", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"newAMatrix", "=", "aMatrix"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"newAMatrix", ",", 
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "numberOfNodes"}], "}"}]}], "]"}]}], "]"}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"i", "\[LessEqual]", 
               RowBox[{"numberOfNodes", "+", "1"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{
                 RowBox[{"newAMatrix", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"i", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"nodeCoords", ",", 
              RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"aMatrix", "=", "newAMatrix"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"addEdge", "=", 
        RowBox[{"Function", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aMatrix", "[", 
           RowBox[{"[", 
            RowBox[{"originNode", ",", "arrivalNode"}], "]"}], "]"}], "=", 
          "1"}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"drawArrow", "=", 
        RowBox[{"Function", "[", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "displacement", ",", "\[IndentingNewLine]", "displacementNorm", 
             ",", "\[IndentingNewLine]", "offset"}], "\[IndentingNewLine]", 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"notNull", "[", "originNode", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"arrivalNode", "=", 
               RowBox[{"getClosestNode", "[", "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"notNull", "[", "arrivalNode", "]"}], "&&", 
                 RowBox[{"arrivalNode", "\[NotEqual]", "originNode"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"locked", "=", "True"}], ";", "\[IndentingNewLine]", 
                 
                 RowBox[{"tempEdge", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Opacity", "[", "1", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "0.03", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nodeCoords", "[", 
                    RowBox[{"[", "originNode", "]"}], "]"}], ",", 
                    RowBox[{"nodeCoords", "[", 
                    RowBox[{"[", "arrivalNode", "]"}], "]"}]}], "}"}], ",", 
                    "2"}], "]"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"locked", "=", "False"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"displacement", "=", 
                  RowBox[{
                   RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}], 
                   "-", 
                   RowBox[{"nodeCoords", "[", 
                    RowBox[{"[", "originNode", "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"displacementNorm", "=", 
                  RowBox[{"Norm", "[", "displacement", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"displacementNorm", ">", "3"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"offset", "=", 
                    RowBox[{"displacement", "*", 
                    RowBox[{"2", "/", "displacementNorm"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"tempEdge", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "1", "]"}], ",", 
                    RowBox[{"Arrowheads", "[", "0.03", "]"}], ",", 
                    RowBox[{"Arrow", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"nodeCoords", "[", 
                    RowBox[{"[", "originNode", "]"}], "]"}], "+", "offset"}], 
                    ",", 
                    RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}],
                     "}"}], "]"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
                  "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"getClosestNode", "=", 
        RowBox[{"Function", "[", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "n", ",", "singleValue", ",", "distance", ",", "closestNode", ",",
              "i", ",", "newDistance"}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{"Length", "[", "nodeCoords", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"singleValue", "=", "True"}], ";", "\[IndentingNewLine]", 
            
            RowBox[{"distance", "=", "Infinity"}], ";", "\[IndentingNewLine]", 
            RowBox[{"closestNode", "=", "Null"}], ";", "\[IndentingNewLine]", 
            
            RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"i", "\[LessEqual]", "n"}], "&&", "singleValue"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newDistance", "=", 
                RowBox[{"EuclideanDistance", "[", 
                 RowBox[{
                  RowBox[{"nodeCoords", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"MousePosition", "[", "\"\<Graphics\>\"", "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"newDistance", "==", "distance"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"singleValue", "=", "False"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"newDistance", "<", "distance"}], ")"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"newDistance", "<", "4"}], ")"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"distance", "=", "newDistance"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"closestNode", "=", "i"}]}]}], 
                  "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "closestNode"}]}], "\[IndentingNewLine]", 
          "]"}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"handleAction", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"event", ",", "\[IndentingNewLine]", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"modKey", ",", "l"}], "}"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{
             RowBox[{"modKey", "=", 
              RowBox[{"CurrentValue", "[", "\"\<ModifierKeys\>\"", "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"l", "=", 
              RowBox[{"Length", "[", "modKey", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"l", "\[Equal]", "0"}], "&&", 
                RowBox[{"event", "==", "\"\<MouseClicked\>\""}]}], ",", 
               RowBox[{"addNode", "[", "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"l", "\[Equal]", "0"}], "&&", 
                RowBox[{"event", "\[Equal]", "\"\<MouseDown\>\""}]}], ",", 
               RowBox[{"originNode", "=", 
                RowBox[{"getClosestNode", "[", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"l", "\[Equal]", "0"}], "&&", 
                RowBox[{"event", "==", "\"\<MouseDragged\>\""}]}], ",", 
               RowBox[{"drawArrow", "[", "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"event", "\[Equal]", "\"\<MouseUp\>\""}], "&&", 
                RowBox[{"Not", "[", "locked", "]"}]}], ",", 
               RowBox[{"resetActionVariables", "[", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"event", "\[Equal]", "\"\<MouseUp\>\""}], "&&", 
                "locked"}], ",", 
               RowBox[{
                RowBox[{"addEdge", "[", "]"}], ";", 
                RowBox[{"resetActionVariables", "[", "]"}]}]}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"EventHandler", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Dynamic", "@", 
          RowBox[{"AdjacencyGraph", "[", 
           RowBox[{"aMatrix", ",", 
            RowBox[{"VertexCoordinates", "\[Rule]", "nodeCoords"}], ",", 
            RowBox[{"Epilog", "\[Rule]", "tempEdge"}], ",", 
            RowBox[{"VertexSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"2", ",", "2"}], "}"}]}], ",", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "30"}], ",", 
            RowBox[{"FrameTicks", "\[Rule]", "Automatic"}], ",", 
            RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<MouseDragged\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"handleAction", "[", "\"\<MouseDragged\>\"", "]"}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"handleAction", "[", "\"\<MouseClicked\>\"", "]"}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<MouseDown\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"handleAction", "[", "\"\<MouseDown\>\"", "]"}], ")"}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<MouseUp\>\"", "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"handleAction", "[", "\"\<MouseUp\>\"", "]"}], ")"}]}]}],
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQfYPJ+06DyhtHvjON90F00AnexrlAOmB1EJh+U6o/
EUS/vHJ2CoiWWfZoJoje+2jhbBC9pfD8fBD9i/3IShDNtsj4JIh+dNb5NIg2
2chwD0QvmyDzAEQXsb55C6LtviR8BNFcQusZ5wHpnOy9PCD609lmARD9cXWu
KIjeG1IpBaIv3bNTANFP9JpUQLSSha0qiI5gjkkA0Wq/LoBpGbPsbBC95GQR
mD5/5ukmEH315TswfSk/+8N8IG0m2wCmj1ns5loApPMFdPlAtF93qhCI/lO7
QRhEb5otoQii91+erQyil1W/5fNSfeMoOY9RAETzvSwVAdFfti6XANGy8v93
+wFpsQtf94BoAIyxrOY=
  "],
 CellLabel->"In[35]:=",ExpressionUUID->"7a82ec05-0dbe-47e1-87ac-446d92fb8729"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"graphPanel", "[", "]"}]], "Input",
 CellChangeTimes->{{3.777055862056822*^9, 3.777055865503337*^9}, {
  3.777056853877653*^9, 3.777056855530157*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"ed648e38-dc74-4519-a064-e3ac81693adc"],

Cell[BoxData[
 TagBox[
  DynamicBox[ToBoxes[
    Pane[
     AdjacencyGraph[$CellContext`aMatrix$12534, 
      VertexCoordinates -> $CellContext`nodeCoords$12534, 
      Epilog -> $CellContext`tempEdge$12534, VertexSize -> {2, 2}, Frame -> 
      True, PlotRange -> 30, FrameTicks -> Automatic, GridLines -> 
      Automatic]], StandardForm],
   ImageSizeCache->{360., {176., 181.}}],
  EventHandlerTag[{
   "MouseDragged" :> $CellContext`handleAction["MouseDragged"], 
    "MouseClicked" :> $CellContext`handleAction["MouseClicked"], 
    "MouseDown" :> $CellContext`handleAction["MouseDown"], 
    "MouseUp" :> $CellContext`handleAction["MouseUp"], Method -> "Preemptive",
     PassEventsDown -> Automatic, PassEventsUp -> True}]]], "Output",
 CellChangeTimes->{
  3.777220860159377*^9, 3.777221002881969*^9, 3.777224659067691*^9, {
   3.77722484987539*^9, 3.777224875949257*^9}, 3.7772249667447023`*^9, 
   3.77722534664082*^9, 3.777225426890648*^9, {3.777225572373019*^9, 
   3.77722557638595*^9}, 3.777225607448207*^9, 3.777227426271748*^9, 
   3.7772280858678513`*^9, 3.777228119824181*^9, 3.777228183392457*^9, 
   3.777231401195099*^9, 3.777231496639778*^9, 3.7772315443687563`*^9, {
   3.777231874523534*^9, 3.7772318985050373`*^9}, 3.777232136728134*^9, 
   3.777232170267706*^9, 3.7772322082264013`*^9, 3.777232337237556*^9, 
   3.777232521507873*^9, {3.7772329162582817`*^9, 3.777232954274757*^9}, {
   3.7772330568554153`*^9, 3.7772330805727797`*^9}, 3.77723390338367*^9, 
   3.7772339358956747`*^9, {3.777234069908557*^9, 3.777234085555181*^9}, {
   3.777234281619843*^9, 3.7772343088640623`*^9}, {3.777234464043374*^9, 
   3.777234491879355*^9}, 3.777235690217558*^9, 3.777235955105196*^9, {
   3.77723604127978*^9, 3.777236057088435*^9}, 3.77723610732365*^9, 
   3.77723810561052*^9, 3.777238143790902*^9, 3.7772385583088827`*^9, 
   3.7772387126775913`*^9, 3.7772387638298473`*^9, 3.777239368123764*^9, 
   3.7772395061565742`*^9, 3.777239580023862*^9, 3.777239738638073*^9, 
   3.777239817428917*^9, 3.777240327804036*^9, 3.777240440462524*^9, 
   3.7772404895400457`*^9, 3.777240526177165*^9, {3.777240662127187*^9, 
   3.777240688454836*^9}, 3.77724098695842*^9, {3.777241111867782*^9, 
   3.777241123296258*^9}, {3.777241153800671*^9, 3.7772411653668623`*^9}, 
   3.777241872280263*^9, 3.777241919436167*^9, 3.777241954648761*^9, 
   3.777242008190649*^9, {3.777242041365885*^9, 3.777242059081121*^9}, 
   3.777242094066957*^9, 3.777293328645793*^9, {3.777295172235408*^9, 
   3.7772951993939533`*^9}, 3.777295352358376*^9, 3.777298325162135*^9, {
   3.777298510086335*^9, 3.7772985530610657`*^9}, 3.777298722282119*^9, 
   3.7776464417331553`*^9, 3.777646745899311*^9, 3.7776467933298197`*^9, 
   3.777648627626092*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"6498fead-81c1-46f2-b4ae-f38a4a864c24"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"modKey", "\[Equal]", 
   RowBox[{"{", 
    RowBox[{"\"\<Command\>\"", ",", "\"\<Alt\>\""}], "}"}]}]}]], "Input",
 CellChangeTimes->{
  3.7772323322368307`*^9, {3.777235602971784*^9, 
   3.777235618942749*^9}},ExpressionUUID->"d2a9b2ac-11b4-4087-8df4-\
90126e0def44"]
},
WindowSize->{1237, 755},
WindowMargins->{{3, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4999, 119, 724, "Input",ExpressionUUID->"268c18ec-2a20-406e-a17c-e9e0fb4da4ce"],
Cell[5560, 141, 156, 3, 30, "Input",ExpressionUUID->"7789435e-6e40-4db0-8be4-6cd58d49e335"],
Cell[5719, 146, 177, 3, 30, "Input",ExpressionUUID->"a328df04-c69b-4ff9-a715-e2ffd5343689"],
Cell[5899, 151, 1600, 36, 52, "Input",ExpressionUUID->"c6453f2f-8ac9-4f00-9fa2-e622e4a527e6"],
Cell[CellGroupData[{
Cell[7524, 191, 634, 13, 30, "Input",ExpressionUUID->"451b7111-16ee-44ba-bf7d-3c536b493a0e"],
Cell[8161, 206, 1338, 25, 229, "Output",ExpressionUUID->"9111b64d-2c64-495e-992a-02d2fcd5fa4a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9536, 236, 290, 6, 30, "Input",ExpressionUUID->"a8f26e4e-98ad-4766-bd91-461786c0940b"],
Cell[9829, 244, 1614, 33, 127, "Output",ExpressionUUID->"f1bc1213-b1b0-4c6f-93e8-16136168eb39"]
}, Open  ]],
Cell[11458, 280, 168, 3, 30, "Input",ExpressionUUID->"b33ce7e8-b975-447e-8581-142ccb6e683f"],
Cell[CellGroupData[{
Cell[11651, 287, 862, 21, 73, "Input",ExpressionUUID->"2bebbf99-f8f6-434c-97e1-4e52b9bba141"],
Cell[12516, 310, 570, 11, 34, "Output",ExpressionUUID->"31862016-d7a3-454e-a7df-10a1c0035f9f"]
}, Open  ]],
Cell[13101, 324, 590, 13, 30, "Input",ExpressionUUID->"f7d94a30-ff33-4578-9c00-4218ff3761bb"],
Cell[13694, 339, 564, 12, 30, "Input",ExpressionUUID->"27f68aee-3581-427a-9925-090fbb926d3c"],
Cell[14261, 353, 129, 3, 30, "Input",ExpressionUUID->"ab3dd3e8-d75f-4a3d-8442-a436cb6678f5"],
Cell[CellGroupData[{
Cell[14415, 360, 187, 2, 30, "Input",ExpressionUUID->"f39510a3-8f7a-4a1a-ab7b-1fdffd103d94"],
Cell[14605, 364, 160, 2, 34, "Output",ExpressionUUID->"cbf301a3-586f-491e-bdb9-d22d86866af8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14802, 371, 722, 18, 30, "Input",ExpressionUUID->"ccda298a-6f54-4a06-9708-713513589d80"],
Cell[15527, 391, 289, 6, 24, "Print",ExpressionUUID->"057fabcc-6cbb-4487-ad92-5c1fed05f441"]
}, Open  ]],
Cell[15831, 400, 156, 3, 30, "Input",ExpressionUUID->"afb3fa59-c89f-4f6e-ab2d-9e4c4e9a3efc"],
Cell[15990, 405, 129, 3, 30, "Input",ExpressionUUID->"9f0e60b7-423d-4406-a0ad-a40ee8db7ec4"],
Cell[CellGroupData[{
Cell[16144, 412, 825, 22, 73, "Input",ExpressionUUID->"3834825e-41c4-4d9c-a8bd-dace26627a5d"],
Cell[16972, 436, 645, 15, 34, "Output",ExpressionUUID->"7ed8bfff-0f59-4f04-896b-d53489533681"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17654, 456, 1833, 35, 115, "Input",ExpressionUUID->"2f03301e-58ed-4bcc-9499-183e73eaaeae"],
Cell[19490, 493, 903, 17, 117, "Output",ExpressionUUID->"916f3578-5003-4ca3-a3e9-fd4522834fa4"],
Cell[CellGroupData[{
Cell[20418, 514, 142, 2, 24, "Print",ExpressionUUID->"2edebf36-158b-479e-b9bd-83a3c0ff9bc6"],
Cell[20563, 518, 140, 2, 24, "Print",ExpressionUUID->"8b82d613-7486-4a19-b890-51d62c8ca6b4"],
Cell[20706, 522, 142, 2, 24, "Print",ExpressionUUID->"d479e5d2-63ee-4458-9a67-836ad7c3ea85"],
Cell[20851, 526, 142, 2, 24, "Print",ExpressionUUID->"cc7e5abf-bcec-4995-ba07-5e7679a4090f"],
Cell[20996, 530, 142, 2, 24, "Print",ExpressionUUID->"8d950539-6ad7-4f6c-8df2-29b46c64faf3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21187, 538, 1156, 26, 115, "Input",ExpressionUUID->"78a8a015-6b98-45b3-aa32-210b0a8057a2"],
Cell[22346, 566, 559, 14, 117, "Output",ExpressionUUID->"b84d3ae4-a91c-4f6c-827c-d77270eedc1d"],
Cell[CellGroupData[{
Cell[22930, 584, 142, 2, 24, "Print",ExpressionUUID->"3074ecb4-d6c5-4715-b00c-46124fbfd1d0"],
Cell[23075, 588, 144, 2, 24, "Print",ExpressionUUID->"4e1be556-89cd-47e5-aaf2-ad4e03d96ccb"],
Cell[23222, 592, 141, 2, 24, "Print",ExpressionUUID->"10a6842b-8cb1-4384-9bd5-cc2e38cd310e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23412, 600, 1082, 27, 96, "Input",ExpressionUUID->"41fcb8d8-8adc-49ea-ae69-cc7cdd723e2e"],
Cell[24497, 629, 890, 25, 34, "Output",ExpressionUUID->"ac46f58f-26bb-4366-98dc-c10ada7cf71e"]
}, Open  ]],
Cell[25402, 657, 4066, 90, 283, "Input",ExpressionUUID->"375bdd94-dcce-42c8-bbd5-a89c89d8e59c"],
Cell[29471, 749, 15847, 336, 2756, "Input",ExpressionUUID->"7a82ec05-0dbe-47e1-87ac-446d92fb8729"],
Cell[CellGroupData[{
Cell[45343, 1089, 252, 4, 30, "Input",ExpressionUUID->"ed648e38-dc74-4519-a064-e3ac81693adc"],
Cell[45598, 1095, 2819, 45, 374, "Output",ExpressionUUID->"6498fead-81c1-46f2-b4ae-f38a4a864c24"]
}, Open  ]],
Cell[48432, 1143, 324, 8, 52, "Input",ExpressionUUID->"d2a9b2ac-11b4-4087-8df4-90126e0def44"]
}
]
*)

